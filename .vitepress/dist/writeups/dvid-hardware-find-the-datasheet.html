<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>DVID - Hardware - Find the Datasheet | shoxxdj.fr</title>
    <meta name="description" content="Le blog d'un pentester bidouilleur">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/assets/style.CXd3M5F4.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.DG1idRyy.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.D9JvoNW6.js">
    <link rel="modulepreload" href="/assets/chunks/framework.CgkrJXe5.js">
    <link rel="modulepreload" href="/assets/writeups_dvid-hardware-find-the-datasheet.md.aDcbInKc.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d8b57b2d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-fcbfc0e0></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-fcbfc0e0>Skip to content</a><!--]--><!----><header class="VPNav" data-v-d8b57b2d data-v-7ad780c2><div class="VPNavBar" data-v-7ad780c2 data-v-9fd4d1dd><div class="wrapper" data-v-9fd4d1dd><div class="container" data-v-9fd4d1dd><div class="title" data-v-9fd4d1dd><div class="VPNavBarTitle" data-v-9fd4d1dd data-v-9f43907a><a class="title" href="/" data-v-9f43907a><!--[--><!--]--><!----><span data-v-9f43907a>shoxxdj.fr</span><!--[--><!--]--></a></div></div><div class="content" data-v-9fd4d1dd><div class="content-body" data-v-9fd4d1dd><!--[--><!--]--><div class="VPNavBarSearch search" data-v-9fd4d1dd><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-9fd4d1dd data-v-afb2845e><span id="main-nav-aria-label" class="visually-hidden" data-v-afb2845e> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/writeups.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Writeups</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/cve.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>CVE</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/articles.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Articles</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-9fd4d1dd data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-9fd4d1dd data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/shoxxdj" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://x.com/shoxxdj" aria-label="twitter" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-twitter"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-9fd4d1dd data-v-f953d92f data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-bfe7971f><span class="vpi-more-horizontal icon" data-v-bfe7971f></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><!----><!--[--><!--[--><!----><div class="group" data-v-f953d92f><div class="item appearance" data-v-f953d92f><p class="label" data-v-f953d92f>Appearance</p><div class="appearance-action" data-v-f953d92f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-f953d92f data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f953d92f><div class="item social-links" data-v-f953d92f><div class="VPSocialLinks social-links-list" data-v-f953d92f data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/shoxxdj" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://x.com/shoxxdj" aria-label="twitter" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-twitter"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-9fd4d1dd data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-9fd4d1dd><div class="divider-line" data-v-9fd4d1dd></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-d8b57b2d data-v-2488c25a><div class="container" data-v-2488c25a><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2488c25a data-v-6b867909><button data-v-6b867909>Return to top</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-d8b57b2d data-v-9a6c75ad><div class="VPDoc has-aside" data-v-9a6c75ad data-v-e6f2a212><!--[--><!--]--><div class="container" data-v-e6f2a212><div class="aside" data-v-e6f2a212><div class="aside-curtain" data-v-e6f2a212></div><div class="aside-container" data-v-e6f2a212><div class="aside-content" data-v-e6f2a212><div class="VPDocAside" data-v-e6f2a212 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-f610f197><div class="content" data-v-f610f197><div class="outline-marker" data-v-f610f197></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-f610f197>On this page</div><ul class="VPDocOutlineItem root" data-v-f610f197 data-v-53c99d69><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e6f2a212><div class="content-container" data-v-e6f2a212><!--[--><!--]--><main class="main" data-v-e6f2a212><div style="position:relative;" class="vp-doc _writeups_dvid-hardware-find-the-datasheet" data-v-e6f2a212><div><p>Dvid est un projet créé par <a href="https://twitter.com/Vulcainreo" target="_blank" rel="noreferrer">@Vulcainreo</a> afin de faciliter l’apprentissage des attaques sur des devices IOT. Concrètement c&#39;est un package vendu pour ~30€ comprenant une board, des modules ( bluetooth ect ) et des outils d&#39;attaques ( pour la version complète ). Voyons ensemble le writeup de la première épreuve !</p><h3 id="installation" tabindex="-1">Installation <a class="header-anchor" href="#installation" aria-label="Permalink to &quot;Installation&quot;">​</a></h3><p>Tout d&#39;abord, partons du principe que vous avez commandé et reçu le package comprenant les outils d&#39;attaques. La fin de l&#39;article comporte également une partie avec le <a href="http://dangerousprototypes.com/docs/Bus_Pirate" target="_blank" rel="noreferrer">bus pirate</a>.</p><h4 id="chargement-du-module" tabindex="-1">Chargement du module <a class="header-anchor" href="#chargement-du-module" aria-label="Permalink to &quot;Chargement du module&quot;">​</a></h4><p>Commençons par récupérer les fichiers du projet et plaçons nous dans le répertoire du challenge :</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>git clone https://github.com/Vulcainreo/DVID.git cd DVID/training/hardware/findTheDatasheet</span></span></code></pre></div><p>Le challenge ne nécessite pas de modules spécifiques, nous pouvons directement le flasher sur la carte. Pour cela nous utilisons <em>avrdude</em> (installez le si nécessaire) ainsi que le dongle usb AVR programmer</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>sudo avrdude -c usbasp -p m328p -U flash:w:findTheDatasheet.ino.arduino_standard.hex</span></span></code></pre></div><p><img src="/medias/writeups/dvid-hardware-find-the-datasheet/IMG_20190710_145338-1024x576.jpg" alt="Flash de la carte"></p><h3 id="challenge" tabindex="-1">Challenge <a class="header-anchor" href="#challenge" aria-label="Permalink to &quot;Challenge&quot;">​</a></h3><p>Pour résoudre le challenge j&#39;utilise le dongle USB to TTL pour alimenter la carte. Celle ci supporte le 5v et le dongle permet de sortir du 5V.</p><p>L&#39;écran nous indique : &quot;Connect RX to the PD1 pin to get the password&quot;</p><p>Cherchons tout d&#39;abord à traduire cette phrase. Comme certains le savent je pratique le FPV, par ce biais j&#39;ai appris que RX était un terme utilisé pour récepteur. Un peu plus de <a href="https://learn.sparkfun.com/tutorials/serial-communication/all" target="_blank" rel="noreferrer">recherches</a> nous permettent de savoir que RX/TX sont des récepteurs/émetteurs séries. Ainsi une version simplifié de la phrase donnerais :</p><p>&quot;Connectez un récepteur série sur le pin PD1 pour obtenir le password&quot;</p><h4 id="trouver-le-pin-pd1" tabindex="-1">Trouver le pin PD1 <a class="header-anchor" href="#trouver-le-pin-pd1" aria-label="Permalink to &quot;Trouver le pin PD1&quot;">​</a></h4><p>Première étape, trouver ce fameux pin. Si vous soulevez l&#39;écran vous pourrez voir la référence de la puce utilisée par la board, il s&#39;agit d&#39;une ATMega328p. Une rapide recherche google nous permet d&#39;obtenir les noms des pins :</p><p><img src="/medias/writeups/dvid-hardware-find-the-datasheet/ATMega328P-Pinout.png" alt="Résultat de recherche d&#39;images pour &quot;pd1 atmega 328p&quot;"></p><p>Le pin PD1 correspond à un emmeteur (TX). Peu étonnant RX et TX sont très souvent associé pour effectuer des communications.</p><p>Nous pourrions alors simplement connecter un jumper sur le pin de l&#39;ATMega328p et le relier à un récepteur série. Ce serait possible ici car la puce est accessible physiquement. Mais ce n&#39;est pas le but du challenge.</p><p>Dans le repertoire git, se trouve des Gerber Files. Ces fichiers sont utilisés pour concevoir des circuits électroniques. Ouvrons les dans l&#39;utilitaire gerbv :</p><p><img src="/medias/writeups/dvid-hardware-find-the-datasheet/image-1024x762.png" alt="Gerber File"></p><p>Nous pouvons ici suivre le lien entre le pin PD1 de l&#39;ATMega et le pin TX de la board.</p><h4 id="lecture-du-flag" tabindex="-1">Lecture du flag <a class="header-anchor" href="#lecture-du-flag" aria-label="Permalink to &quot;Lecture du flag&quot;">​</a></h4><p>Au début de ce writeup j&#39;ai décidé d&#39;utiliser le lecteur série USB &quot;un peu par hasard&quot; afin d&#39;alimenter la board en 5V. A l&#39;avenir j&#39;essayerais d&#39;utiliser un composant externe. Nous savons ou connecter les cables ( TX de la board, RX du dongle USB ) il ne nous reste plus qu&#39;à lire le password en écoutant le sur le port serie RX.</p><p>Cela peut être fait grâce à ce script python permettant d’interagir avec le lecteur USB.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>import serial</span></span>
<span class="line"><span>port = &#39;/dev/ttyUSB0&#39; rate = 9600</span></span>
<span class="line"><span>ser = serial.Serial(port,rate) read = ser.readline().decode(&#39;utf-8&#39;) print(read)</span></span></code></pre></div><p>J&#39;utilise ici la librairie pyserial, le port peut être déterminé en utilisant les logs dmseg.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>dmesg| grep tty</span></span>
<span class="line"><span>✘ usb 1-4: cp210x converter now attached to ttyUSB0</span></span></code></pre></div><p><img src="/medias/writeups/dvid-hardware-find-the-datasheet/image-1.png" alt="A la demande de l&#39;auteur, le flag est volontairement caché"></p><h3 id="resolution-avec-un-bus-pirate-v4" tabindex="-1">Résolution avec un bus pirate v4 <a class="header-anchor" href="#resolution-avec-un-bus-pirate-v4" aria-label="Permalink to &quot;Résolution avec un bus pirate v4&quot;">​</a></h3><p>Cette carte traînait dans mon tiroir depuis quelques temps et je cherchais une occasion d&#39;apprendre à l&#39;utiliser (merci DVID ! ).</p><p>Pour résoudre ce challenge, vous avez besoin d&#39;un bus pirate capable de lire des données en UART. Si ce n&#39;est pas le cas, c&#39;est surement que votre Bus pirate n&#39;est pas à jour.</p><h4 id="flash-de-la-carte" tabindex="-1">Flash de la carte <a class="header-anchor" href="#flash-de-la-carte" aria-label="Permalink to &quot;Flash de la carte&quot;">​</a></h4><p>Assurez vous de relier les ports PGC et PGD via un jumper puis :</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>git clone https://github.com/BusPirate/Bus\_Pirate.git cd Bus_Pirate/package/BPv4-firmware/pirate-loader-v4-source/pirate-loader\_lnx sudo ./pirate-loader\_lnx --dev=/dev/ttyACM0 --hex=../BPv4-firmware-v6.3-r2151.hex</span></span></code></pre></div><p>Votre bus pirate doit maintenant être flashé et pret à lire des infos via UART.</p><h4 id="reception-du-flag" tabindex="-1">Reception du flag <a class="header-anchor" href="#reception-du-flag" aria-label="Permalink to &quot;Reception du flag&quot;">​</a></h4><p>Tout d&#39;abord, branchons le bus pirate et connectons nous :</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>sudo gtkterm -s 115200 -p /dev/ttyACM0</span></span></code></pre></div><p>Pour les branchements des pins, la partie 5V/GND est assez simple. Cependant contrairement au dongle USB to TTL le bus pirate n&#39;a pas de port RX explicitement décris. Une <a href="http://dangerousprototypes.com/blog/bus-pirate-manual/bus-pirate-uart-guide/" target="_blank" rel="noreferrer">rapide recherche</a> nous indique qu&#39;il s&#39;agit du port MISO.</p><p>Entrons dans la console du bus pirate.</p><p><img src="/medias/writeups/dvid-hardware-find-the-datasheet/image-2.png" alt=""></p><p>Je ne vais pas expliciter la configuration du lecteur, cette partie est assez intuitive. Une fois la configuration faite il n&#39;y a plus qu&#39;a alimenter la carte avec la commande <em>W</em>. L&#39;écran de la board s&#39;allume. On peut à présent lire les données via le bus RX à l&#39;aide de la commande <em>{</em>. Nous obtenons alors les différents caractères du password sous forme hexadécimale :</p><p><img src="/medias/writeups/dvid-hardware-find-the-datasheet/image-3.png" alt="Lecture du flag par le bus pirate"></p><h2 id="conclusion" tabindex="-1">Conclusion <a class="header-anchor" href="#conclusion" aria-label="Permalink to &quot;Conclusion&quot;">​</a></h2><p>And voila ! Ce premier niveau de DVID permet de nous lancer facilement dans l&#39;étude des protocoles IOT et hardware. Le projet est vraiment chouette, une communauté commence à se former sur le discord dédié et les possibilités d&#39;évolutions sont très intéressantes. N&#39;hésitez pas à vous lancer !</p></div></div></main><footer class="VPDocFooter" data-v-e6f2a212 data-v-1bcd8184><!--[--><!--]--><!----><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api-examples.md\":\"CZMwDm7k\",\"articles_active-directory.md\":\"B4GyZEwv\",\"articles_angr-basics.md\":\"Bz5ruunm\",\"articles_bypass-nx-ret2libc-binaire-x86.md\":\"CO3cONEE\",\"articles_exploitation-binaire-x86-sans-protections.md\":\"C0CKFp9n\",\"articles_fin-de-hackdumb.md\":\"BLBy9NDK\",\"articles_format-strings.md\":\"BDhETb4q\",\"articles_index.md\":\"DKvF9Q-f\",\"articles_mon-premier-bidouillage-iot.md\":\"BzEdB8Cx\",\"articles_un-nouveau-blog.md\":\"DJ3GLHQS\",\"cve_index.md\":\"C1BHcQ4z\",\"cve_the-story-of-cve-2021-3029.md\":\"CudztYq1\",\"index.md\":\"DJHeSLf4\",\"markdown-examples.md\":\"BumudoiO\",\"writeups_dvid-firmware-defaultpassword.md\":\"qOXQLNEw\",\"writeups_dvid-hardware-find-the-datasheet.md\":\"aDcbInKc\",\"writeups_index.md\":\"BMxmvIKl\",\"writeups_miley-a-ctf-challenge-story.md\":\"CZlUgW4K\",\"writeups_rootedcon-by-advens.md\":\"CwxBcE5T\",\"writeups_vm-mr-robot.md\":\"D5C2l6Tl\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"shoxxdj.fr\",\"description\":\"Le blog d'un pentester bidouilleur\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Writeups\",\"link\":\"/writeups\"},{\"text\":\"CVE\",\"link\":\"/cve\"},{\"text\":\"Articles\",\"link\":\"/articles\"}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/shoxxdj\"},{\"icon\":\"twitter\",\"link\":\"https://x.com/shoxxdj\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>